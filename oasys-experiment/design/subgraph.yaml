subgraph:
  name: oasys-bridge-stats
  description: |
    OasysネットワークのL2（Verse）ブリッジイベントを追跡し、
    bridgeされたOAS量を集計するサブグラフ

entities:
  BridgeEvent:
    description: ブリッジイベント（デポジット/出金）
    fields:
      id: ID! # トランザクションハッシュ + ログインデックス
      verseId: Int! # VerseのID
      chainName: String! # Verseの名前
      eventType: String! # "DEPOSIT" or "WITHDRAWAL"
      from: Bytes! # 送信者アドレス
      to: Bytes! # 受信者アドレス
      amount: BigInt! # 量（wei単位）
      timestamp: BigInt! # タイムスタンプ
      blockNumber: BigInt! # ブロック番号
      transactionHash: Bytes! # トランザクションハッシュ

  DailyBridgeStats:
    description: 日次のブリッジ統計
    fields:
      id: ID! # verseId + 日付（YYYY-MM-DD）
      verseId: Int! # VerseのID
      chainName: String! # Verseの名前
      date: String! # 日付（YYYY-MM-DD）
      eventType: String! # "DEPOSIT" or "WITHDRAWAL"
      total_amount: BigInt! # その日の総量
      count: Int! # その日のイベント数

contracts:
  ChainVerseBridge:
    network: mainnet
    rpc: https://rpc.chainverse.info/
    address: "0x24d133Df1d72089809945EC9550f72f8415AC780"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  DefiVerseBridge:
    network: mainnet
    rpc: https://rpc.defi-verse.org
    address: "0x0cc5366BE800cf73daB2DBfDE031C255a6f1E3cC"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  GeekVerseBridge:
    network: mainnet
    rpc: https://rpc.geekout-pte.com
    address: "0x62Ec33Ea441d654008d5E631D11B6A3cb7034e31"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  GesoVerseBridge:
    network: mainnet
    rpc: https://rpc.verse.gesoten.com/
    address: "0x9F740B3E8E823E68294eEA69299908E3FdEe1Ea7"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  HOMEVerseBridge:
    network: mainnet
    rpc: https://rpc.mainnet.oasys.homeverse.games
    address: "0x9245e19eB88de2534E03E764FB2a5f194e6d97AD"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  MCHVerseBridge:
    network: mainnet
    rpc: https://rpc.oasys.mycryptoheroes.net
    address: "0xA16517A9796bAc73eFA7d07269F9818b7978dc2A"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  SaakuruVerseBridge:
    network: mainnet
    rpc: https://rpc.saakuru.network
    address: "0x4FfA6d5745C2E78361ae91a36312524284F3D812"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  TCGVerseBridge:
    network: mainnet
    rpc: https://rpc.tcgverse.xyz
    address: "0xa34a85ecb19c88d4965EcAfB10019E63050a1098"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  XPLAVerseBridge:
    network: mainnet
    rpc: https://rpc-xpla-verse.xpla.dev/
    address: "0x80d7aAB75B4144AF77E04C1A334e7236Be4771d0"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

  YooldoVerseBridge:
    network: mainnet
    rpc: https://rpc.yooldo-verse.xyz
    address: "0xf6944626a2EA29615e05f3AC9Ab2568e8E004e9D"
    events:
      - ETHDepositInitiated
      - ETHWithdrawalFinalized

event_definitions:
  ETHDepositInitiated:
    description: OASデポジットイベント
    parameters:
      - name: from
        type: address
        indexed: true
      - name: to
        type: address
        indexed: true
      - name: amount
        type: uint256
        indexed: false
      - name: extraData
        type: bytes
        indexed: false

  ETHWithdrawalFinalized:
    description: OAS出金完了イベント
    parameters:
      - name: from
        type: address
        indexed: true
      - name: to
        type: address
        indexed: true
      - name: amount
        type: uint256
        indexed: false
      - name: extraData
        type: bytes
        indexed: false

mappings:
  - event: ETHDepositInitiated
    handler: handleETHDepositInitiated
    entities:
      - BridgeEvent
      - DailyBridgeStats

  - event: ETHWithdrawalFinalized
    handler: handleETHWithdrawalFinalized
    entities:
      - BridgeEvent
      - DailyBridgeStats

queries:
  - name: 日次ブリッジ統計
    description: |
      Verseごとの日次統計を取得
    example: |
      {
        dailyBridgeStats(
          where: { verseId: 1 }
          orderBy: date,
          orderDirection: desc,
          first: 7
        ) {
          date
          verseId
          chainName
          eventType
          total_amount
          count
        }
      }

  - name: 最新のブリッジイベント
    description: |
      最新のブリッジイベントを取得
    example: |
      {
        bridgeEvents(
          first: 10,
          orderBy: timestamp,
          orderDirection: desc
        ) {
          verseId
          chainName
          eventType
          from
          to
          amount
          timestamp
        }
      } 